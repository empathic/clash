[meta]
name = "all tool types"
description = "Test permission checking for Bash, Read, Write, and Edit tools"

[settings.user]
permissions.allow = ["Bash(git:*)", "Read", "Write(/tmp/*)"]
permissions.deny = ["Edit(.env)"]

[[step]]
name = "bash allowed"
hook = "pre-tool-use"
tool_name = "Bash"
tool_input = { command = "git status" }

[step.expect]
decision = "allow"

[[step]]
name = "read allowed (blanket)"
hook = "pre-tool-use"
tool_name = "Read"
tool_input = { file_path = "/home/user/code/main.rs" }

[step.expect]
decision = "allow"

[[step]]
name = "write to /tmp allowed"
hook = "pre-tool-use"
tool_name = "Write"
tool_input = { file_path = "/tmp/test.txt", content = "hello" }

[step.expect]
decision = "allow"

[[step]]
name = "write elsewhere asks"
hook = "pre-tool-use"
tool_name = "Write"
tool_input = { file_path = "/home/user/important.txt", content = "hello" }

[step.expect]
decision = "ask"

[[step]]
name = "edit .env denied"
hook = "pre-tool-use"
tool_name = "Edit"
tool_input = { file_path = ".env", old_string = "KEY=old", new_string = "KEY=new" }

[step.expect]
decision = "deny"

[[step]]
name = "edit other file asks"
hook = "pre-tool-use"
tool_name = "Edit"
tool_input = { file_path = "main.rs", old_string = "old", new_string = "new" }

[step.expect]
decision = "ask"
