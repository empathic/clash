# Clash policy for Eliot's dev environment.
#
# Evaluation: all matching statements are collected, then precedence applies:
#   deny > ask > allow
# If no statement matches, the default effect is used.

# Notifications: desktop alerts and Zulip bot for remote permission resolution.
# When a permission request evaluates to "ask", clash can forward it to Zulip
# and poll for a human response (approve/deny).
notifications:
  desktop: true
  zulip:
    server_url: "https://your-org.zulipchat.com"
    bot_email: "clash-bot@your-org.zulipchat.com"
    bot_api_key: "your-bot-api-key"
    stream: "clash-permissions"
    topic: "requests"
    timeout_secs: 120

default:
  permission: ask
  profile: research

profiles:
  safe-ssh:
    rules:
      deny * *:
        fs:
          read + write: subpath(~/.ssh)
  
  safe-read:
    rules:  
      allow safe-read *:

  research:
    include: [safe-ssh, safe-read]
    rules:
      allow bash *:
        args: ["!-delete"]
        fs:
          read: "!regex(\\./)" # no hidden files
      allow read *:
        fs:
          read: "!(regex(\\./))"
  
